<Window x:Class="OpenEasyN2N.view.ToolboxWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="联机增强工具 - WinIPBroadcast" Height="380" Width="520"
        WindowStartupLocation="CenterScreen" ResizeMode="NoResize"
        WindowStyle="None" AllowsTransparency="True" Background="Transparent">

    <Window.Resources>
        <SolidColorBrush x:Key="AccentBrush" Color="#007ACC"/>

        <Style x:Key="CloseButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Border" Background="{TemplateBinding Background}" CornerRadius="0,12,0,0">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#E81123"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ToggleSwitchStyle" TargetType="ToggleButton">
            <Setter Property="Width" Value="50"/>
            <Setter Property="Height" Value="24"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border x:Name="Border" CornerRadius="12" Background="#333333">
                            <Ellipse x:Name="Dot" Width="18" Height="18" Fill="#AAAAAA" HorizontalAlignment="Left" Margin="3,0">
                                <Ellipse.RenderTransform>
                                    <TranslateTransform X="0"/>
                                </Ellipse.RenderTransform>
                            </Ellipse>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="{StaticResource AccentBrush}"/>
                                <Setter TargetName="Dot" Property="Fill" Value="White"/>
                                <Trigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="Dot" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" To="26" Duration="0:0:0.15"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.EnterActions>
                                <Trigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="Dot" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" To="0" Duration="0:0:0.15"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </Trigger.ExitActions>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Border CornerRadius="12" Background="#1A1A1B" BorderBrush="#333333" BorderThickness="1">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="32"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Border Grid.Row="0" Background="#1A1A1B" CornerRadius="12,12,0,0" MouseLeftButtonDown="TitleBar_MouseDown">
                <Grid>
                    <TextBlock Text="联机增强工具箱" Foreground="#666666" FontSize="10" Margin="15,0" VerticalAlignment="Center"/>
                    <Button Style="{StaticResource CloseButtonStyle}"
                            Content="✕"
                            HorizontalAlignment="Right"
                            Width="45"
                            Foreground="Gray"
                            Click="BtnClose_Click"/>
                </Grid>
            </Border>

            <Grid Grid.Row="1" Margin="25,10,25,25">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1.1*"/>
                    <ColumnDefinition Width="0.9*"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" VerticalAlignment="Center" Margin="0,0,15,0">
                    <TextBlock Text="WinIPBroadcast 1.6" Foreground="White" FontSize="16" FontWeight="Bold" Margin="0,0,0,5"/>
                    <TextBlock Text="多网卡UDP广播同步工具" Foreground="#888888" FontSize="11" Margin="0,0,0,20"/>

                    <Border Background="#252526" CornerRadius="8" Padding="15" BorderBrush="#333333" BorderThickness="1">
                        <StackPanel>
                            <Grid>
                                <StackPanel>
                                    <TextBlock Text="运行状态" FontSize="10" Foreground="#AAAAAA" Margin="0,0,0,5"/>
                                    <StackPanel Orientation="Horizontal">
                                        <Ellipse x:Name="StatusDot" Width="8" Height="8" Fill="Gray" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                        <TextBlock x:Name="StatusText" Text="检测中..." Foreground="White" FontSize="13" FontWeight="SemiBold"/>
                                    </StackPanel>
                                </StackPanel>
                                <ToggleButton x:Name="BtnToggle" Style="{StaticResource ToggleSwitchStyle}" HorizontalAlignment="Right" VerticalAlignment="Center" Click="BtnToggle_Click"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <TextBlock Text="* 该工具以Windows服务方式常驻后台" Foreground="#555555" FontSize="10" Margin="5,15,0,0" TextWrapping="Wrap"/>
                </StackPanel>

                <Border Grid.Column="1" Background="#121212" CornerRadius="12" BorderBrush="#2D2D30" BorderThickness="1">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="12">
                        <StackPanel>
                            <TextBlock Text="原理说明" Foreground="{StaticResource AccentBrush}" FontSize="11" FontWeight="Bold" Margin="0,0,0,8"/>
                            <TextBlock Text="Windows默认只向主网卡发送全球广播（255.255.255.255）。在联机时，如果游戏尝试搜寻局域网房间，往往只能搜到物理局域网而忽略了n2n虚拟网络。"
                                       Foreground="#BBBBBB" FontSize="10" TextWrapping="Wrap" LineHeight="15"/>

                            <TextBlock Text="WinIPBroadcast通过监听回环地址，捕获这些广播包并强制转发到所有活动网卡上。这解决了红警3、魔兽争霸3、CS1.6等老游戏搜不到房间的痛点。"
                                       Foreground="#BBBBBB" FontSize="10" TextWrapping="Wrap" Margin="0,10,0,0" LineHeight="15"/>

                            <Rectangle Height="1" Fill="#252526" Width="100" HorizontalAlignment="Left" Margin="0,12"/>

                            <TextBlock Text="作者: Etienne Dechamps" Foreground="#555555" FontSize="9"/>
                            <TextBlock Text="开源协议: GPL" Foreground="#555555" FontSize="9"/>
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Window>